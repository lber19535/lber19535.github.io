<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="manifest" href="/manifest.json">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha256-xejo6yLi6vGtAjcMIsY8BHdKsLg7QynVlFMzdQgUuy8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lber19535.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.12.3","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本文是对Android文档中关于动画部分的简单翻译和自己的一些理解。 Android 提供了两种动画系统：Property Animation(Android 3.0+)，和 View Animation。虽然两种都可以用，但是通常更推荐Property Animation，因为它更加灵活且有更多的功能。除此之外，还可以利用 Drawable Animation，它可以加载一系列的 drawabl">
<meta property="og:type" content="article">
<meta property="og:title" content="Android动画">
<meta property="og:url" content="https://lber19535.github.io/2015/04/03/2015/2015-04-03-Android%E5%8A%A8%E7%94%BB/index.html">
<meta property="og:site_name" content="LOST HOME">
<meta property="og:description" content="本文是对Android文档中关于动画部分的简单翻译和自己的一些理解。 Android 提供了两种动画系统：Property Animation(Android 3.0+)，和 View Animation。虽然两种都可以用，但是通常更推荐Property Animation，因为它更加灵活且有更多的功能。除此之外，还可以利用 Drawable Animation，它可以加载一系列的 drawabl">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://developer.android.com/images/animation/animation-linear.png">
<meta property="og:image" content="http://developer.android.com/images/animation/animation-nonlinear.png">
<meta property="og:image" content="http://developer.android.com/images/animation/valueanimator.png">
<meta property="article:published_time" content="2015-04-03T17:00:00.000Z">
<meta property="article:modified_time" content="2022-08-30T09:51:54.416Z">
<meta property="article:author" content="Bill Lv">
<meta property="article:tag" content="Android">
<meta property="article:tag" content="Animation">
<meta property="article:tag" content="Framework">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://developer.android.com/images/animation/animation-linear.png">


<link rel="canonical" href="https://lber19535.github.io/2015/04/03/2015/2015-04-03-Android%E5%8A%A8%E7%94%BB/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://lber19535.github.io/2015/04/03/2015/2015-04-03-Android%E5%8A%A8%E7%94%BB/","path":"2015/04/03/2015/2015-04-03-Android动画/","title":"Android动画"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Android动画 | LOST HOME</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S001LDMM2K"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-S001LDMM2K","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">LOST HOME</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">YESTERDAY YOU SAID TOMORROW</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Property-Animation"><span class="nav-number">1.</span> <span class="nav-text">1.Property Animation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-Property-Ainmation-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 Property Ainmation 工作原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Property-Animation-%E5%92%8C-View-Animation-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 Property Animation 和 View Animation 的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-API-%E7%BB%BC%E8%BF%B0"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 API 综述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-ValueAnimator-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 ValueAnimator 的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-ObjectAnimator-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.5.</span> <span class="nav-text">1.5 ObjectAnimator 的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-AnimatorSet"><span class="nav-number">1.6.</span> <span class="nav-text">1.6 AnimatorSet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-7-Animation-Listeners"><span class="nav-number">1.7.</span> <span class="nav-text">1.7 Animation Listeners</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-8-ViewGroups-%E7%9A%84%E5%8A%A8%E7%94%BB"><span class="nav-number">1.8.</span> <span class="nav-text">1.8 ViewGroups 的动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-9-TypeEvaluator"><span class="nav-number">1.9.</span> <span class="nav-text">1.9 TypeEvaluator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-10-Interpolator"><span class="nav-number">1.10.</span> <span class="nav-text">1.10 Interpolator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-11-Keyframes"><span class="nav-number">1.11.</span> <span class="nav-text">1.11 Keyframes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-12-ViewPropertyAnimator"><span class="nav-number">1.12.</span> <span class="nav-text">1.12 ViewPropertyAnimator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-13-%E7%94%A8-XML-%E5%AE%9A%E4%B9%89%E5%8A%A8%E7%94%BB"><span class="nav-number">1.13.</span> <span class="nav-text">1.13 用 XML 定义动画</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-View-Animation"><span class="nav-number">2.</span> <span class="nav-text">2.View Animation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Drawable-Animation"><span class="nav-number">3.</span> <span class="nav-text">3.Drawable Animation</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Bill Lv</p>
  <div class="site-description" itemprop="description">YESTERDAY YOU SAID TOMORROW</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">45</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lber19535.github.io/2015/04/03/2015/2015-04-03-Android%E5%8A%A8%E7%94%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Bill Lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOST HOME">
      <meta itemprop="description" content="YESTERDAY YOU SAID TOMORROW">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Android动画 | LOST HOME">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Android动画
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2015-04-03 17:00:00" itemprop="dateCreated datePublished" datetime="2015-04-03T17:00:00+00:00">2015-04-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-08-30 09:51:54" itemprop="dateModified" datetime="2022-08-30T09:51:54+00:00">2022-08-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="firestore-visitors-count"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>本文是对<a target="_blank" rel="noopener" href="http://developer.android.com/guide/topics/graphics/overview.html">Android文档中关于动画部分</a>的简单翻译和自己的一些理解。</p>
<p>Android 提供了两种动画系统：<a target="_blank" rel="noopener" href="http://developer.android.com/guide/topics/graphics/prop-animation.html">Property Animation</a>(Android 3.0+)，和 <a target="_blank" rel="noopener" href="http://developer.android.com/guide/topics/graphics/view-animation.html">View Animation</a>。虽然两种都可以用，但是通常更推荐Property Animation，因为它更加灵活且有更多的功能。除此之外，还可以利用 <a target="_blank" rel="noopener" href="http://developer.android.com/guide/topics/graphics/drawable-animation.html">Drawable Animation</a>，它可以加载一系列的 drawable 资源文件，并逐帧显示。</p>
<span id="more"></span>

<h2 id="1-Property-Animation"><a href="#1-Property-Animation" class="headerlink" title="1.Property Animation"></a>1.Property Animation</h2><p>Android 3.0 引入，它可以让你对任何对象的属性做动画，包括不是渲染在屏幕上的。这套机制还是可扩展的，可以把动画效果用于自定义的属性。</p>
<p>Property Animation 是一套健壮的框架系统，你可以用它为任何东西加一个变化的过程。你可以定义一个动画，它可以在一段时间内改变对象的属性，不论这个对象是否会被画到界面上。Property Animation 更改的是对象的属性（对象内的全局变量）。你可以指定想要改变的属性发生变化，例如对象在屏幕上的位置，改变的时间，改变过程中的一系列值。</p>
<p>Property Animation 让你可以定义变化中一系列特征：</p>
<ul>
<li>持续时间：可以定义动画过程的时间，默认是300ms。</li>
<li>时间插值：定义属性值的变化和时间之间的函数关系。</li>
<li>重复次数和表现：可以指定动画重复次数和倒叙播放。</li>
<li>动画集合：把动画组织到一起，同时播放或者根据一个次序播放。</li>
<li>刷新频率：可以指定多久刷新一次，默认的刷新频率是10ms一次，但是刷新的频率完全取决于系统现在有多忙和系统可以提供的最快的频率（所以设置好的时间也不一定会按照这个时间来有时可能会提前有时可能也会滞后一点，刷新太频繁也可能会成为动画卡顿的一个原因）。</li>
</ul>
<h3 id="1-1-Property-Ainmation-工作原理"><a href="#1-1-Property-Ainmation-工作原理" class="headerlink" title="1.1 Property Ainmation 工作原理"></a>1.1 Property Ainmation 工作原理</h3><p>首先让我来看下 Animation 是如何在这个简单的例子上工作的。图1假设了一个有x属性的对象，并且随着x变化，对象在屏幕上的位置也会移动。时间长度是40ms，移动距离是40px。根据默认的刷新频率，每10ms这个对象水平移动10px。40ms结束后，动画停止，对象也移动到了40px的地方。这个例子的动画用到了线性插值器，意味着移动的速率是保持不变的。</p>
<p><img src="http://developer.android.com/images/animation/animation-linear.png" alt="Figure 1. Example of a linear animation"></p>
<p>当然也可以使用非线性的插值器。图2假设了这样一个对象，在开始是加速，结尾是减速。对象依旧是40ms移动了40px，但不是线性运动。开始的时候动画在前半程加速，半程过后开始减速直到动画结束。如图2所示，运动开始和结束运动的距离小于中间运动的距离。</p>
<p><img src="http://developer.android.com/images/animation/animation-nonlinear.png" alt="Figure 2. Example of a non-linear animation"></p>
<p>让我们仔细看一下 Property Animation 的组件之间是如何计算出之前那些运动状态的。图3描述了主要的一些类之间是如何协作的。</p>
<p><img src="http://developer.android.com/images/animation/valueanimator.png" alt="Figure 3. How animations are calculated"></p>
<p><a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/ValueAnimator.html">ValueAnimator</a> 会持续跟踪运动时间，例如动画已经跑了多久和当下属性的值是多少。</p>
<p><a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/ValueAnimator.html">ValueAnimator</a> 封装了运动插值器的接口 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/TimeInterpolator.html">TimeInterpolator</a> 和如何计算动画中的属性值的 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/TypeEvaluator.html">TypeEvaluator</a> 接口。例如图2中的 TimeInterpolator 用的是 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/view/animation/AccelerateDecelerateInterpolator.html">AccelerateDecelerateInterpolator</a> , TypeEvaluator 用的是 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/IntEvaluator.html">IntEvaluator</a>。</p>
<p>在动画开始时，创建一个 ValueAnimator，对需要动化的属性设置起始和终止的值并设置时间。当你调用 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/package-summary.html">start()</a> 方法时，动画开始。在整个动画过程中， ValueAnimator 基于动画总时间和已经用掉的时间计算出一个介于0到1之间的 <em>elapsed fraction</em>。<em>elapsed fraction</em> 表示动画时间完成的百分比，0表示0%，1表示100%。例如图1中在t&#x3D;10ms的时候 <em>elapsed fraction</em> 是0.25，因为整个动画长度是40ms。</p>
<p>当 ValueAnimator 计算完 <em>elapsed fraction</em> 后，它会调用当前设置的 TimeInterpolator 去计算  <em>interpolator fraction</em>。<em>interpolator fraction</em> 和 <em>elapsed fraction</em> 通过 TimeInterpolator 实现其对应关系。例如，图2中，t&#x3D;10ms时，动画开始时加速较慢 <em>elapsed fraction</em> 是 0.25， <em>interpolator fraction</em> 是0.15。图1中，t&#x3D;10ms时，<em>elapsed fraction</em> 和 <em>interpolator fraction</em> 都是0.25。</p>
<p>当 <em>interpolator fraction</em> 计算完后， ValueAnimator 会调用对应的 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/view/animation/package-summary.html">TypeEvaluator</a>，根据属性的其实终止值和 <em>interpolator fraction</em> 计算当前属性的值。例如图2中，<em>interpolator fraction</em> 是0.15，t&#x3D;10ms，所以x&#x3D;0.15*（40 - 0）&#x3D;6。</p>
<p>API Demos 中的 com.example.android.apis.animation 包含大量的 Property Animation 的例子。</p>
<h3 id="1-2-Property-Animation-和-View-Animation-的区别"><a href="#1-2-Property-Animation-和-View-Animation-的区别" class="headerlink" title="1.2 Property Animation 和 View Animation 的区别"></a>1.2 Property Animation 和 View Animation 的区别</h3><p>View Animation 只能用于 View 对象，所以如果你想要动化其他的对象只能自己去实现。View Animation 也仅仅支持很少的几种动画，例如旋转，缩放但是不支持背景颜色。</p>
<p>另一个缺点就是 View Animation 仅仅改变了 View 绘制的位置，并没有真正的改变 View 中有关绘制位置的属性。例如，当你对一个按钮添加一个穿过屏幕的属性，动画播放完后，按钮的真实位置还在原来的地方，而不是穿过屏幕后最终的位置，所以还需要自己在结束后更改 View 本身的属性。</p>
<p>在 Property Animation 中以上的限制全都没有了，你可以给任何对象和属性加动画，并且他们的值会随之更改。 Property Animation 系统同样十分健壮。更高级的，你可以对你想要其改变的属性指定 Animator 比如颜色，位置，大小和动画的其他方面，例如插值器和多个动画的同时播放等。</p>
<p>View Animation 使用时需要的代码较少。如果 View Animation 可以做到，或者已经存在的使用 View Animation 的代码已经达到了你的要求，那么就没有必要使用 Property Animation。当然也可以根据不同情况使用不同的动画系统。</p>
<h3 id="1-3-API-综述"><a href="#1-3-API-综述" class="headerlink" title="1.3 API 综述"></a>1.3 API 综述</h3><p>你可以在 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/package-summary.html">android.animation</a> 中找到大部分的 Property Animation 的 API。View Animation 中已经定义了大量的插值器可以直接拿来用 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/view/animation/package-summary.html">android.view.animation</a>。下面表格描述 Property Animation 中的主要组件。</p>
<p><a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/Animator.html">Animator</a> 提供了动画的基础结构。通常你不需要直接使用这个类，这个类只是一个抽象类。表格中列举了一些 Animator 的子类。</p>
<table>
<thead>
<tr>
<th align="left">Class</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">[ValueAnimator][12]</td>
<td align="left">主要时间引擎同时负责动画过程中实时值的计算。它包含了每个动画是否重复，监听器和自定义的 Evaluator。动态更改属性分两个步骤：计算需要变化的值，将值设置到对应的属性上。ValueAnimator 不实现第二步。所以你必须监听更新状态去更改对应的属性值。后会有详细的说明。</td>
</tr>
<tr>
<td align="left">[ObjectAnimator][19]</td>
<td align="left">ValueAnimator 的子类，可以设置目标对象及系要改变的属性。当计算出新的值时他会相应的更新到目标对象中（实现了父类未实现的第二步）。大部分情况下你应该使用这个类，相比 ValueAnimator 对目标的操作更简单。有时也许你还需要用 ValueAnimator，因为 ObjectAnimator 的使用有一些限制，比如需要目标对象有修改相应值的方法（使用了反射去寻找对应值的getter和setter）。</td>
</tr>
<tr>
<td align="left">[AnimatorSet][20]</td>
<td align="left">提供了一种组织几个动画共同运行的机制。你可以设置几个动画同时运行，按顺序运行或者间隔特定的时间。</td>
</tr>
</tbody></table>
<p>通过 Evaluator，Property Animation 知道如何计算相应的属性。通过 Animator 对象提供的与时间有关的数据，可以计算出开始和结束的值。Property Animation 提供了以下几种 Evaluator。</p>
<table>
<thead>
<tr>
<th align="left">Class&#x2F;Interface</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">[IntEvaluator][16]</td>
<td>对应int类型</td>
</tr>
<tr>
<td align="left">[FloatEvaluator][21]</td>
<td>float类型</td>
</tr>
<tr>
<td align="left">[ArgbEvaluator][22]</td>
<td>计算颜色值，用16进制表示</td>
</tr>
<tr>
<td align="left">[TypeEvaluator][23]</td>
<td>这个接口允许你创建自己的 Evaluator ，如果你想给一个对象的属性加入动画效果，而这个属性不是 int，float，color，那么你就必须实现一个 Evaluator 计算这个属性的值。当然，当你不想用默认的效果时，也可以实现针对 int，float，color 的 Evaluator 来定制不一样的效果。</td>
</tr>
</tbody></table>
<p>时间插值器定义了计算动画中的值的方法。例如，你可以运行一个匀速的线性的动画，或者指定一种非线性的过程，例如开始加速然后减速。下表展示了一些插值器，如果没有你需要的，那么你就要实现 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/TimeInterpolator.html">TimeInterpolator</a> 创建自己的插值器。</p>
<table>
<thead>
<tr>
<th align="left">Class&#x2F;Interface</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">[AccelerateDecelerateInterpolator][25]</td>
<td>开始加速，结尾减速</td>
</tr>
<tr>
<td align="left">[AccelerateInterpolator][26]</td>
<td>逐渐加速</td>
</tr>
<tr>
<td align="left">[AnticipateInterpolator][27]</td>
<td>先缓慢向后然后飞速向前</td>
</tr>
<tr>
<td align="left">[AnticipateOvershootInterpolator][28]</td>
<td>缓慢向后，飞速向前超过 end 的值，然后再回到 end 的值</td>
</tr>
<tr>
<td align="left">[BounceInterpolator][29]</td>
<td>弹跳，类似于皮球落下再弹起来</td>
</tr>
<tr>
<td align="left">[CycleInterpolator][30]</td>
<td>循环，可设置循环次数</td>
</tr>
<tr>
<td align="left">[DecelerateInterpolator][31]</td>
<td>由快到慢</td>
</tr>
<tr>
<td align="left">[LinearInterpolator][32]</td>
<td>匀速</td>
</tr>
<tr>
<td align="left">[OvershootInterpolator][33]</td>
<td>向前飞速超过 end 值，然后慢慢还原</td>
</tr>
<tr>
<td align="left">[TimeInterpolator][34]</td>
<td>插值器接口，用来实现自己的插值器</td>
</tr>
</tbody></table>
<h3 id="1-4-ValueAnimator-的使用"><a href="#1-4-ValueAnimator-的使用" class="headerlink" title="1.4 ValueAnimator 的使用"></a>1.4 ValueAnimator 的使用</h3><p><a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/animation/ValueAnimator.html">ValueAnimator</a>可以通过设置一组int，float或者color来实现对应的动画。你可以通过ofInt(),ofFloat()或ofObject()获取ValueAnimator。下面是例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ValueAnimator</span> <span class="variable">animation</span> <span class="operator">=</span> ValueAnimator.ofFloat(<span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line">animation.setDuration(<span class="number">1000</span>);</span><br><span class="line">animation.start();</span><br></pre></td></tr></table></figure>
<p>这个ValueAnimator计算动画从0开始到1结束，时长1000ms。</p>
<p>也可以自己定义Evaluator使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ValueAnimator</span> <span class="variable">animation</span> <span class="operator">=</span> ValueAnimator.ofObject(<span class="keyword">new</span> <span class="title class_">MyTypeEvaluator</span>(), startPropertyValue, endPropertyValue);</span><br><span class="line">animation.setDuration(<span class="number">1000</span>);</span><br><span class="line">animation.start();</span><br></pre></td></tr></table></figure>
<p>动画的起始和结束分别是startPropertyValue和endPropertyValue，计算的方法是MyTypeEvaluator，时长为1000ms。<br>ValueAnimator 并不会去修改对象的值，他只负责计算出来每一时刻的值。</p>
<h3 id="1-5-ObjectAnimator-的使用"><a href="#1-5-ObjectAnimator-的使用" class="headerlink" title="1.5 ObjectAnimator 的使用"></a>1.5 ObjectAnimator 的使用</h3><p>ObjectAnimator 是 ValueAnimator 的子类，它整合了对对象属性随时间和对应值的计算，这样就不需要自己再去继承 ValueAnimator.AnimatorUpdateListener 来更新对象的状态了，这一切都会自动完成。<br>使用 ObjectAnimator 和 ValueAnimator 很类似，区别之处就是要指定要改变的对象和其属性。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ObjectAnimator</span> <span class="variable">anim</span> <span class="operator">=</span> ObjectAnimator.ofFloat(foo, <span class="string">&quot;alpha&quot;</span>, <span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line">anim.setDuration(<span class="number">1000</span>);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure>

<p>下面是一些需要注意的地方：</p>
<ul>
<li><p>想要改变的对象的属性必须要有 setter 方法，格式是 set<propertyName>()，在 ObjectAnimator 运行的时候会自动调用该方法去更新对应的属性。例如这里的 “alpha”，就需要有一个 setAlpha() 的方法。如果这个类没有对应的方法的怎么办：</p>
<pre><code>  1.如果可以修改这个类，那么给他加个对应的 setter 方法。
  2.如果修改不了就对这个类再做一个封装，加入对应的 setter 方法。
  3.如果前两条都不好用，那么只能用 ValueAnimator 了。
</code></pre>
</li>
<li><p>如果在 values… 的地方只写了一个 value，那么就需要这个属性有一个对应 getter 方法来获取对应的初始值。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ObjectAnimator.ofFloat(targetObject, <span class="string">&quot;propName&quot;</span>, <span class="number">1f</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>getter 和 setter 涉及的类型要一样</p>
</li>
<li><p>有的 View 中的属性修改后需要在 onAnimationUpdate 中手动 invalidate，大部分属性的 setter 方法自带这个功能。</p>
</li>
</ul>
<h3 id="1-6-AnimatorSet"><a href="#1-6-AnimatorSet" class="headerlink" title="1.6 AnimatorSet"></a>1.6 AnimatorSet</h3><p>很多情况下你需要不止一个动画效果作用于一个对象，这时候就需要将多个动画打包成一个 AnimatorSet：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AnimatorSet</span> <span class="variable">bouncer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnimatorSet</span>();</span><br><span class="line">bouncer.play(bounceAnim).before(squashAnim1);</span><br><span class="line">bouncer.play(squashAnim1).with(squashAnim2);</span><br><span class="line">bouncer.play(squashAnim1).with(stretchAnim1);</span><br><span class="line">bouncer.play(squashAnim1).with(stretchAnim2);</span><br><span class="line">bouncer.play(bounceBackAnim).after(stretchAnim2);</span><br><span class="line"><span class="type">ValueAnimator</span> <span class="variable">fadeAnim</span> <span class="operator">=</span> ObjectAnimator.ofFloat(newBall, <span class="string">&quot;alpha&quot;</span>, <span class="number">1f</span>, <span class="number">0f</span>);</span><br><span class="line">fadeAnim.setDuration(<span class="number">250</span>);</span><br><span class="line"><span class="type">AnimatorSet</span> <span class="variable">animatorSet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnimatorSet</span>();</span><br><span class="line">animatorSet.play(bouncer).before(fadeAnim);</span><br><span class="line">animatorSet.start();</span><br></pre></td></tr></table></figure>
<p>AnimatorSet 可以指定动画的先后顺序，甚至是同时运行。更多功能请参考 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/animation/AnimatorSet.html">API</a></p>
<h3 id="1-7-Animation-Listeners"><a href="#1-7-Animation-Listeners" class="headerlink" title="1.7 Animation Listeners"></a>1.7 Animation Listeners</h3><p>动画执行的过程中会会触发一些回调函数</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/animation/Animator.AnimatorListener.html">Animator.AnimatorListener</a><br> 1.onAnimationStart() 动画开始的时候调用<br> 2.onAnimationEnd() 动画结束调用<br> 3.onAnimationRepeat() 当动画重复播放的时候调用了&#x3D;<br> 4.onAnimationCancel() 动画取消调用，随后还会调用 onAnimationEnd<br> 5.onAnimationEnd() 动画结束调用</li>
<li><a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/animation/ValueAnimator.AnimatorUpdateListener.html">ValueAnimator.AnimatorUpdateListener</a><br> 1.onAnimationUpdate() 动画的每一帧都会调用</li>
</ul>
<p>当使用 Listener 的时候由于是个接口，可能有些用不到的方法会让代码变多，可以选择使用 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/animation/AnimatorListenerAdapter.html">AnimatorListenerAdapter</a> ：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ValueAnimatorAnimator</span> <span class="variable">fadeAnim</span> <span class="operator">=</span> ObjectAnimator.ofFloat(newBall, <span class="string">&quot;alpha&quot;</span>, <span class="number">1f</span>, <span class="number">0f</span>);</span><br><span class="line">fadeAnim.setDuration(<span class="number">250</span>);</span><br><span class="line">fadeAnim.addListener(<span class="keyword">new</span> <span class="title class_">AnimatorListenerAdapter</span>() &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAnimationEnd</span><span class="params">(Animator animation)</span> &#123;</span><br><span class="line">    balls.remove(((ObjectAnimator)animation).getTarget());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-8-ViewGroups-的动画"><a href="#1-8-ViewGroups-的动画" class="headerlink" title="1.8 ViewGroups 的动画"></a>1.8 ViewGroups 的动画</h3><p>ViewGroups 的动画效果使用的是 LayoutTransition，当调用 setVisibility() 设置 VISIBLE 或者 GONE 时，就会触发对应的动画。动画分为四种类型：</p>
<ul>
<li>APPEARING child 出现的时候</li>
<li>CHANGE_APPEARING  添加 child 的时候其他 child 的变化</li>
<li>DISAPPEARING   child 消失的时候</li>
<li>CHANGE_DISAPPEARING 删除 child 的时候其他 child 的变化</li>
</ul>
<p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LayoutTransition</span> <span class="variable">transition</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LayoutTransition</span>();</span><br><span class="line"><span class="type">ObjectAnimator</span> <span class="variable">addAnimator</span> <span class="operator">=</span> ObjectAnimator.ofFloat(<span class="literal">null</span>, <span class="string">&quot;alpha&quot;</span>, <span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line">addAnimator.setDuration(<span class="number">3000</span>);</span><br><span class="line">transition.setAnimator(LayoutTransition.APPEARING, addAnimator);</span><br><span class="line"><span class="type">ObjectAnimator</span> <span class="variable">removeAnimator</span> <span class="operator">=</span> ObjectAnimator.ofFloat(<span class="literal">null</span>, <span class="string">&quot;alpha&quot;</span>, <span class="number">1f</span>, <span class="number">0f</span>);</span><br><span class="line">removeAnimator.setDuration(<span class="number">3000</span>);</span><br><span class="line">transition.setAnimator(LayoutTransition.DISAPPEARING, removeAnimator);</span><br><span class="line"></span><br><span class="line">targetLv.setLayoutTransition(transition);</span><br></pre></td></tr></table></figure>
<p>targetLv 是个 layout，当向 layout 中添加 child 的时候动画效果就会发生。系统自带一个默认的动画，可以通过 animateLayoutChanges 属性打开：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/verticalContainer&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:animateLayoutChanges</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-9-TypeEvaluator"><a href="#1-9-TypeEvaluator" class="headerlink" title="1.9 TypeEvaluator"></a>1.9 TypeEvaluator</h3><p>如果想动态修改的对象不在 Animator 中，可以通过自定义 TypeEvaluator 来实现。自带的有 IntEvaluator，FloatEvaluator 和 ArgbEvaluator。<br>这个东西只有一个方法，下面是 FloatEvaluator 的实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FloatEvaluator</span> <span class="keyword">implements</span> <span class="title class_">TypeEvaluator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">evaluate</span><span class="params">(<span class="type">float</span> fraction, Object startValue, Object endValue)</span> &#123;</span><br><span class="line">        <span class="type">float</span> <span class="variable">startFloat</span> <span class="operator">=</span> ((Number) startValue).floatValue();</span><br><span class="line">        <span class="keyword">return</span> startFloat + fraction * (((Number) endValue).floatValue() - startFloat);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个 fraction 是百分比，和之前讲过的插值器有关，是用来描述当前动画的进度。</p>
<h3 id="1-10-Interpolator"><a href="#1-10-Interpolator" class="headerlink" title="1.10 Interpolator"></a>1.10 Interpolator</h3><p>插值器，定义对应时间如何计算对应的值。内置的插值器在<a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/view/animation/package-summary.html">这里</a>。插值器只有一个方法，用来返回当前时间所对应的值。例如：<br>AccelerateDecelerateInterpolator：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">float</span> <span class="title function_">getInterpolation</span><span class="params">(<span class="type">float</span> input)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">float</span>)(Math.cos((input + <span class="number">1</span>) * Math.PI) / <span class="number">2.0f</span>) + <span class="number">0.5f</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>LinearInterpolator:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">float</span> <span class="title function_">getInterpolation</span><span class="params">(<span class="type">float</span> input)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> input;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的 input 就是动画的进度，和之前的 fraction 是一样的。 </p>
<h3 id="1-11-Keyframes"><a href="#1-11-Keyframes" class="headerlink" title="1.11 Keyframes"></a>1.11 Keyframes</h3><p><a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/animation/Keyframe.html">KeyFrame</a> 从名字看是关键帧，他可以指定在不同 fraction 的时候要达到某一效果的值，然后让对应的插值器去计算他们之间对应的值，例如下面的例子，在 50% 的时候要求对象旋转到360度然后再转回去。<a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/animation/PropertyValuesHolder.html">PropertyValuesHolder</a> 用来保存属性及对应的值，ofXXX 函数的第二个参数是个可变长参数，意味着可以输入一系列的值或关键帧来对动画进行细微的控制。 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Keyframe</span> <span class="variable">kf0</span> <span class="operator">=</span> Keyframe.ofFloat(<span class="number">0f</span>, <span class="number">0f</span>);</span><br><span class="line"><span class="type">Keyframe</span> <span class="variable">kf1</span> <span class="operator">=</span> Keyframe.ofFloat(<span class="number">.5f</span>, <span class="number">360f</span>);</span><br><span class="line"><span class="type">Keyframe</span> <span class="variable">kf2</span> <span class="operator">=</span> Keyframe.ofFloat(<span class="number">1f</span>, <span class="number">0f</span>);</span><br><span class="line"><span class="type">PropertyValuesHolder</span> <span class="variable">pvhRotation</span> <span class="operator">=</span> PropertyValuesHolder.ofKeyframe(<span class="string">&quot;rotation&quot;</span>, kf0, kf1, kf2);</span><br><span class="line"><span class="type">ObjectAnimator</span> <span class="variable">rotationAnim</span> <span class="operator">=</span> ObjectAnimator.ofPropertyValuesHolder(target, pvhRotation)</span><br><span class="line">rotationAnim.setDuration(<span class="number">5000</span>);</span><br></pre></td></tr></table></figure>

<h3 id="1-12-ViewPropertyAnimator"><a href="#1-12-ViewPropertyAnimator" class="headerlink" title="1.12 ViewPropertyAnimator"></a>1.12 ViewPropertyAnimator</h3><p>这个东西在某些情况下可以代替 ObjectAnimator，下面是同一个动画的三种不同写法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ObjectAnimator</span> <span class="variable">animX</span> <span class="operator">=</span> ObjectAnimator.ofFloat(myView, <span class="string">&quot;x&quot;</span>, <span class="number">50f</span>);</span><br><span class="line"><span class="type">ObjectAnimator</span> <span class="variable">animY</span> <span class="operator">=</span> ObjectAnimator.ofFloat(myView, <span class="string">&quot;y&quot;</span>, <span class="number">100f</span>);</span><br><span class="line"><span class="type">AnimatorSet</span> <span class="variable">animSetXY</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnimatorSet</span>();</span><br><span class="line">animSetXY.playTogether(animX, animY);</span><br><span class="line">animSetXY.start();</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">PropertyValuesHolder</span> <span class="variable">pvhX</span> <span class="operator">=</span> PropertyValuesHolder.ofFloat(<span class="string">&quot;x&quot;</span>, <span class="number">50f</span>);</span><br><span class="line"><span class="type">PropertyValuesHolder</span> <span class="variable">pvhY</span> <span class="operator">=</span> PropertyValuesHolder.ofFloat(<span class="string">&quot;y&quot;</span>, <span class="number">100f</span>);</span><br><span class="line">ObjectAnimator.ofPropertyValuesHolder(myView, pvhX, pvyY).start();</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myView.animate().x(<span class="number">50f</span>).y(<span class="number">100f</span>);</span><br></pre></td></tr></table></figure>
<p>最短的这个就是利用 ViewPropertyAnimator 做到的。不过缺点也比较明显，只能设置一个值，不能对同一属性设置多个值。如果动画形式比较单一，那么明显是最后这种比较好，如果是对动画过程中不同时间点要做控制，则使用 Keyframe 和 PropertyValuesHolder 比较好，如果是不同动画所用时间不同，那么就只能分开写 Animator 放到 AnimatorSet 中执行了。</p>
<h3 id="1-13-用-XML-定义动画"><a href="#1-13-用-XML-定义动画" class="headerlink" title="1.13 用 XML 定义动画"></a>1.13 用 XML 定义动画</h3><p>从 Android 3.1+ 开始，xml 定义的动画改到了 res&#x2F;animator&#x2F; 目录，其中对应的标签如下：</p>
<ul>
<li>ValueAnimator - &lt;animator&gt;</li>
<li>ObjectAnimator - &lt;objectAnimator&gt;</li>
<li>AnimatorSet - &lt;set&gt;</li>
</ul>
<p>例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">android:ordering</span>=<span class="string">&quot;sequentially&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">objectAnimator</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:propertyName</span>=<span class="string">&quot;x&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:duration</span>=<span class="string">&quot;500&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:valueTo</span>=<span class="string">&quot;400&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:valueType</span>=<span class="string">&quot;intType&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">objectAnimator</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:propertyName</span>=<span class="string">&quot;y&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:duration</span>=<span class="string">&quot;500&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:valueTo</span>=<span class="string">&quot;300&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:valueType</span>=<span class="string">&quot;intType&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">objectAnimator</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:propertyName</span>=<span class="string">&quot;alpha&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">&quot;500&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:valueTo</span>=<span class="string">&quot;1f&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AnimatorSet</span> <span class="variable">set</span> <span class="operator">=</span> (AnimatorSet) AnimatorInflater.loadAnimator(myContext,</span><br><span class="line">    R.anim.property_animator);</span><br><span class="line">set.setTarget(myObject);</span><br><span class="line">set.start();</span><br></pre></td></tr></table></figure>


<h2 id="2-View-Animation"><a href="#2-View-Animation" class="headerlink" title="2.View Animation"></a>2.View Animation</h2><p>它是一种旧的动画机制，并且只能用于View，相对来说这种更容易使用切提供的功能也是大部分程序所需要的。</p>
<p>这种又被称为补间动画。补间动画通过起点、终点、大小、旋转角度等计算出动画效果。</p>
<p>补间动画可以在View上实现位置、大小、角度、透明度的变化。比如，你有一个 TextView，就可以对它进行移动、旋转、放大、缩小的动画。如果View有background，那么background会随着text一起改变。<a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/view/animation/package-summary.html">Animation Package</a>提供了补间动画用到的所有的类。</p>
<p>补间动画可以通过xml或者代码来定义。定义动画的xml就像定义layout一样，因为这样有可读性、复用且比硬编码更方便。下面的例子中我们将使用xml(想要学习更多的用代码定义Animation的，可以参考 <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/view/animation/AnimationSet.html">AnimationSet</a> 或者 Animation 的其他子类)。</p>
<p>动画的可以定义发生变化的形式、时间和整个动画持续多久。多个动画可以是连续的也可以是同时发生的，例如，你可以将 TextView 的内容从左移到右，接着旋转180°，或者移动的同时旋转。每种变化方式都有一套对应的参数（起始和结束的大小、角度等），还有一些共有的参数（例如，起止时间）。给不同动画相同的起始时间，他们就会同时变化；计算好动画之间的时间，就可以做成连续播放。</p>
<p>Animation xml 文件属于 res&#x2F;anim&#x2F; 目录。文件必须包含一个根节点：可以是<alpha>，<scale>，<translate>，<rotate>，也可以是插值器（interpolator）,或者是动画的集合<set>。默认情况下，所有的动画指令都是同时进行的。如果想要改变发生的次序，你就必须制定 startOffset 的值。</p>
<p>下面是 Apidemos 中的一个例子，用来拉伸的同时旋转和缩小View。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">android:shareInterpolator</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scale</span></span></span><br><span class="line"><span class="tag">	    <span class="attr">android:interpolator</span>=<span class="string">&quot;@android:anim/accelerate_decelerate_interpolator&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXScale</span>=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXScale</span>=<span class="string">&quot;1.4&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYScale</span>=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYScale</span>=<span class="string">&quot;0.6&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotX</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotY</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fillAfter</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">&quot;700&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span> <span class="attr">android:interpolator</span>=<span class="string">&quot;@android:anim/decelerate_interpolator&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scale</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:fromXScale</span>=<span class="string">&quot;1.4&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:toXScale</span>=<span class="string">&quot;0.0&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:fromYScale</span>=<span class="string">&quot;0.6&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:toYScale</span>=<span class="string">&quot;0.0&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:pivotX</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:pivotY</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:startOffset</span>=<span class="string">&quot;700&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:duration</span>=<span class="string">&quot;400&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:fillBefore</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rotate</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:fromDegrees</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:toDegrees</span>=<span class="string">&quot;-45&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:toYScale</span>=<span class="string">&quot;0.0&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:pivotX</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:pivotY</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:startOffset</span>=<span class="string">&quot;700&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:duration</span>=<span class="string">&quot;400&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>屏幕的坐标起点是(0, 0)位于屏幕的左上角，向右和向下时正半轴。</p>
<p>像 pivotX 等一些属性可以设置一个相对于自己本身或者相对于父控件的值。请确定使用正确的格式以达到想要的效果（”50”是将锚点设为父控件的50%， “50%”是将锚点设为自身的50%）。</p>
<p>通过指定 interpolator 来决定动画运行动画如何变化。Android 包含几个 interpolator 的子类来指定速度曲线；例如，<a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/view/animation/AccelerateInterpolator.html">AccelerateInterpolator</a> 表示又慢到快的变化。每个动画都可以设置一个 interpolator。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ImageView</span> <span class="variable">spaceshipImage</span> <span class="operator">=</span> (ImageView) findViewById(R.id.spaceshipImage);</span><br><span class="line"><span class="type">Animation</span> <span class="variable">hyperspaceJumpAnimation</span> <span class="operator">=</span> AnimationUtils.loadAnimation(<span class="built_in">this</span>, R.anim.hyperspace_jump);</span><br><span class="line">spaceshipImage.startAnimation(hyperspaceJumpAnimation);</span><br></pre></td></tr></table></figure>

<p>更多的 xml 语法请参考 <a target="_blank" rel="noopener" href="http://developer.android.com/guide/topics/resources/animation-resource.html">Animation Resources</a>。</p>
<blockquote>
<p>Note:<br>不论你的动画是移动还是改变大小，View 的边界是不会根据动画自动调整的。即使如此，动画也还是会完整的绘制超过 View 边界的部分。当动画超过了父控件，动画效果则会被裁减。 </p>
</blockquote>
<h2 id="3-Drawable-Animation"><a href="#3-Drawable-Animation" class="headerlink" title="3.Drawable Animation"></a>3.Drawable Animation</h2><p>逐帧显示 Drawable，就像胶卷一样。如果想要显示的动画用Drawable更方便表示，那么就推荐使用这种方式。</p>
<p>Drawable Animation会加载一系列的drawable资源文件创建成一个动画，这跟传统的使用有序的连续不断的一系列图片一样。<a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html">AnimationDrawable</a>是Drawable Animation的基础。</p>
<p>你可以用 AnimationDrawable 在代码中定义动画的每一帧，或者使用更为简单的xml文件，xml中列出了的每一帧最后都组成了动画，其中可以设置每一帧持续的时间和帧的顺序。这个xml放在 res&#x2F;drawable&#x2F;目录下。</p>
<p>xml文件由根节点<animation-list>和一系列子节点<item>组成，每个子节点就是一帧，其中可以设置drawable和duration。<a target="_blank" rel="noopener" href="https://github.com/lber19535/AndroidDemo/blob/master/res/drawable/drawable_anim.xml">Example</a>。oneshot 表示是否只播一次，默认为false。</p>
<p>需要注意的是start()方法不能在onCreate()中调用，如果想要activity开始时就运行动画，可以使用onWindowFocusChanged()方法。<a target="_blank" rel="noopener" href="https://github.com/lber19535/AndroidDemo/blob/master/src/com/example/bill/anim/demo/DrawableAnimationActivity.java">Example</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Android/" rel="tag"># Android</a>
              <a href="/tags/Animation/" rel="tag"># Animation</a>
              <a href="/tags/Framework/" rel="tag"># Framework</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2015/03/31/2015/2015-03-31-%E9%A2%9C%E8%89%B2%E5%B7%A5%E5%85%B7/" rel="prev" title="颜色工具">
                  <i class="fa fa-chevron-left"></i> 颜色工具
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2015/04/27/2015/2015-04-27-Android%E8%A7%A6%E6%91%B8%E7%B3%BB%E7%BB%9F/" rel="next" title="Android 触摸系统">
                  Android 触摸系统 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bill Lv</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.9.1/firebase-app-compat.js" integrity="sha256-BZqADJTynzztcubgFmplXDkhMk7o/6KO4tHzL8X+biE=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.9.1/firebase-firestore-compat.js" integrity="sha256-8Y5+rcygX0v5tCQhOjr4rob7oykEcp6IhhutNKKGzfk=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="firestore" type="application/json">{"enable":true,"collection":"articles","apiKey":"AIzaSyAUEkp4sjguJNc-EW2Hu8T3WQ57z931SbA","projectId":"blog-7bba0"}</script>
  <script src="/js/third-party/statistics/firestore.js"></script>




</body>
</html>
